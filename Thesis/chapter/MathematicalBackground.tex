\chapter{Mathematical Background}
\label{MathBack}

In order to understand the mathematical concepts behind the encryption algorithms described here, some basic concepts are explained here. However, you should have a basic knowledge of linear algebra and polynomial calculus.

\section{Lattice}

% Based on \cite{LatticeTutorial}.

All of the algorithms discussed in this thesis are based on lattices, which is why we will briefly focus on them in more detail. In general, lattices behave like any other vector space, but they only consist of discrete vectors. This means that the vectors only contain integers and not real numbers as in a vector space.

Let $B = \{b_1, b_2, \ldots, b_m\}$ be a set of linearly independent vectors of $\mathbb{R}^n$. The lattice $L$ generated by $B$ is the set of integer linear combinations of $B$. $B$ is called the basis of the lattice $L$. That is,
$$L(B) = \{a_1b_1 + \ldots + a_mb_m | a_1, \ldots, a_m \in \mathbb{Z}  \} \subset \mathbb{R}^n$$


Using a matrix $B$, which contains the basis vectors as column vectors, we can generate $L$ equivalently.

$$L(B) = \{Bx | x \in \mathbb{Z}^m  \} \subset \mathbb{R}^n$$

As in this definition, the integer $n$ is the \textbf{dimension} of the lattice and $m$ is its \textbf{rank}. If $m = n$, then $L$ is a \textbf{full-rank} lattice, which is the usual case in this thesis. 

An example of a lattice based on a basis $B$ and all the points that can be created with it, also called the \textbf{span}, can be seen in the figure \ref{fig:latticeGrid}.

\begin{figure}[h]
  \centering
  \includegraphics[scale=0.2]{images/LatticeGrid.png}
  \caption[Span of an Lattice]{The span of an two-dimensional lattice with basis  $B = \{b_1, b_2\}$.}
  \label{fig:latticeGrid}
\end{figure}

% Nur dann ben√∂tigt wenn ich genauer auf die Funktionsweise von LWE eingehen will
% \section{Shortest Vector \& Closest Vector Problem}


\section{Integer \& Polynomial Rings with modulus}
This section is based on \cite{Algebra}.

\subsection*{Rings}
A ring is a set $R$ on which addition ($+$) and multiplication ($\cdot$) can be performed and results in a new Element, which is also part of the set R.
\begin{center}
  $ +: R+R\rightarrow R$ (Addition) and $\cdot: R \cdot R \rightarrow R$ (Multiplication)
\end{center}

These calculations need to fulfill the following conditions:
\begin{description}
  \item for addition: $R$ is an abelian group
        \begin{itemize}
          \item Associative property: $(a+b)+b = a+(b+c) | a,b,c \in R$
          \item Commutative property: $a+b = b+a | a,b \in R$
          \item Additive identity: There exists and element $0 \in R$ so that $a+0 = a | a \in R$
          \item Additive inverse: For each $a \in R$ there is an $-a \in R$ so that $a+(-a)=0$
        \end{itemize}
  \item for multiplication: R is an monoid
        \begin{itemize}
          \item Associative property: $(a\cdot b) \cdot b = a \cdot(b\cdot c) | a,b,c \in R$
          \item Multiplicative identity: There exists and element $1 \in R$ so that $a \cdot 1 = 1 \cdot a = a | a \in R$
        \end{itemize}
  \item Addition and Multiplication are distributive
        \begin{itemize}
          \item  $a\cdot (b + c) = a\cdot b + a\cdot c | a,b,c \in R$
          \item  $(a + b) \cdot c= a\cdot c + b\cdot c | a,b,c \in R$
        \end{itemize}
\end{description}

A ring is also called commutative if the multiplication is also commutative. For example, the ring over all integers $\mathbb{Z}$ is a commutative ring.

\subsection*{Modular arithmetic on Rings}

Congruence arithmetic, or modular arithmetic, is the term used to describe arithmetic with remainders when dividing integers. In everyday life, this is mainly encountered in connection with clocks. After 60 minutes, the minute hand returns to the same position as before. 

More generally, this can be described as $a \equiv b \mod n | a,b \in \mathbb{Z}, n \in \mathbb{N}$, where $n$ is the module by which $a$ and $b$ are divided until the remainder of both is less than $n$. If $a$ and $b$ are then equal, they are congruent. Or in a more mathematical expression: If there is a $k$, such as $a-b = k\cdot m$, then $a$ and $b$ are congruent.

An congruence relation with module $n$ on the set $\mathbb{Z}$, has the following properties:
% Based on \cite{Algebra} Seite 13.
$k,n \in \mathbb{N}$ and $a, a', b, b', c \in \mathbb{Z}$
\begin{enumerate}
  \item $a \equiv a \mod n$ (Reflexivity)
  \item $a \equiv b \mod n$ if $b \equiv a \mod n$ (Symmetry)
  \item If $a \equiv b \mod n$ and $b \equiv c \mod n$ then $a \equiv c \mod n$ (Transitivity)
  \item If $a \equiv a' \mod n$ and $b \equiv b' \mod n$ then $a+b \equiv a'+b' \mod n$
  \item If $a \equiv a' \mod n$ and $b \equiv b' \mod n$ then $a\cdot b \equiv a'\cdot b' \mod n$
  \item If $c$ and $n$ are coprime and $c \cdot a \equiv c \cdot b \mod n$ then $a \equiv b \mod n$
  \item If $a \equiv b \mod k\cdot n$ then $a \equiv b \mod n$
\end{enumerate}

The congruence class is the set of all numbers for an integer $a \in \mathbb{Z}$ modulus $n$ that produce the same remainder. It is defined as
$$[a]_n = \{b \in \mathbb{Z} | a \equiv b \mod n\}$$.

It follows that two numbers are congruent if both congruence classes are equal:

$$a \equiv b \mod n \Leftrightarrow [a]_n = [b]_n$$

With this we can create a set of all congruence classes modulo $n$:
$$\mathbb{Z}_n = \mathbb{Z}/n = \mathbb{Z} \mod n = \{[a]_n | a = 0, 1, \dot, n-1 \}$$.

For example, $Z_3 = \{[0]_3, [1]_3, [2]_3\}$. With addition and multiplication it is possible to create a commutative ring from $\mathbb{Z}_n$.
\begin{center}
    $[a]_n + [b]_n = [a+b]_n$ (addition) and $[a]_n \cdot [b]_n = [a\cdot b]_n$ (multiplication)
\end{center}

This allows to create finite rings $\mathbb{Z}_n$ for every natural number $n$ with $n$ elements in each ring and to perform calculations inside these ring. For example, an ring with $n=60$ can be created, which represents the minutes in every hour. If the minute hand shows now $48$ and we want to know where it is after $3$ times $13$ minutes, we can calculate it like:
$$[48]_{60} + [3]_{60}\cdot [13]_{60} = [48+3\cdot 13]_{60} = [87]_{60} = [27]_{60}$$

\subsection*{Polynomial Rings}

A polynomial with coefficients in a ring $R$ is expressed as 
$$f = a_nx^n + a_{n-1}x^{n-1}+\cdots+a_1x+a_0 | a_0, \cdots, a_n \in R$$

The variable $n$ defines the degree $\deg(f)$ of the polynomial, which is the largest exponent in a polynomial.

They can be added and multiplied like any other polynomial. Such a polynomial ring with one variable $x$ and its coefficients in $R$ is written as $R[x]$. This is a generalization of the rings we had before, because $R$ is a subset of $R[x]$ ($R \subset R[x]$), since $R$ is a polynomial with $\deg(0)$: $R = R[x] := a\cdot x^0 = a$.

Such a polynomial ring can also be defined over a finite ring, so that each coefficient is part of that finite ring. This is written as $R_n = \mathbb{Z}_n[x]$. The coefficients follow the same rules for addition and multiplication as described above. The following example takes place in the ring $R_5 = \mathbb{Z}_5[x]$ and $f, g \in R_5$ with $f=3x^2+2x+1$ and $g=2x+4$:

\begin{align*}
  f\cdot 4 &= (3x^2+2x+1) * 4 \\
      &= [12]_5x^2+[8]_5x+[4]_5 \\
      &= 2x^2+3x+4 \\
  f+g &= (3x^2+2x+1)+(2x+4) \\
      &= [3]_5x^2+[4]_5x+[5]_5\\
      &= 3x^2+4x \\
  f\cdot g &= (3x^2+2x+1)+(2x+4) \\ 
      &= [6]_5x^3+[4]_5x^2+[2]_5x+[12]_5x^2+[8]_5x+[4]_5 \\
      &= [6]_5x^3+[16]_5x^2+[10]_5x+[4]_5 \\
      &= 1x^3+1x^2+0x+4 \\
\end{align*}

As with any polynomial multiplication, the degree can increase as you multiply two polynomials, leading to increasingly larger polynomials with each multiplication. Since the modulo operation creates a finite ring, we can also create a modulo operation that creates a finite ring over a polynomial where the degree stays the same or is less than some upper bound. For this we have a ring $R$ and $f, g, q, r \in R[x], g\neq 0$, where $f$ is a polynomial, $g$ is the modulus, and $r$ is the remainder:
\begin{center}
  $f = g\cdot q + r $ and $\deg(r)<\deg(g)$.
\end{center}

After this calculation, $r$ will be the remainder of $f$ with a degree smaller than that of $g$, which will be used for further calculations. With this, we can now define polynomial rings that have a module to generate finite coefficients and a polynomial function to generate finite degree. This is written as 
$$R_n = \mathbb{Z}_n[x]/f(x)$$

For most cases in cryptography, $f(x)$ will be the function $x^d+1$, as this simplifies the calculation of the remainder. Instead of doing lengthy polynomial divisions, one can simply subtract $d$ from the exponent and invert the coefficient if the exponent is greater than or equal to $d$. This must be repeated until the largest exponent is less than $d$. For example, $f \in \mathbb{Z}_5[x]/(x^3+1)$

\begin{align*}
  f &= 3x^6+x^5+2x^3+4x^2+3 &\mod (x^3+1) \\
    &= -3x^3-x^2-2+4x^2+3 &\mod (x^3+1) \\
    &= 3-x^2-2+4x^2+3 \\
    &= 3x^2+4
\end{align*}

\subsection*{Polynomial Ring multiplication using a Matrix}
