\chapter{Conclusion}

The principal objective of this thesis was to investigate the viability of transferring R-LWE homomorphic encryption schemes to M-LWE and to evaluate the performance of these novel schemes. The viability of this approach was evaluated by developing an M-LWE HE scheme using the BFV scheme \cite{BFV}.
 
As detailed in Section \ref{sec:GeneralizingToMLWE}, it is possible to extend R-LWE-based HE schemes to M-LWE, thereby creating novel HE schemes where not only the polynomial rank $d$ but also the dimension size $n$ of the matrix can be modified. This also permits the creation of Plain-LWE HE schemes, as these are a special case of M-LWE, where $d=1$. To accomplish this, an M-LWE encryption scheme was extended to accommodate homomorphic  addition and multiplication operations. In the case of the addition operation, this was a trivial process, as the values could be added together in the same manner as was done previously with R-LWE. The process for multiplication is somewhat more cumbersome and comprises a greater number of steps. The primary challenge was the generation of an $n \times n$ matrix during the multiplication of the ciphertexts. Given that the resulting ciphertext must retain its original structure, comprising a polynomial and a vector of polynomials, this matrix must be decomposed and incorporated into the other values. By decomposing this matrix and multiplying it with $n$ relinearization keys, rather than a single one, the requisite output structure can be created, which, given a sufficiently large modulus $q$, will decrypt to the desired results. Given the general nature of the decomposition process, it seems reasonable to hypothesize that the same method could be applied with minor modifications to other R-LWE-based HE schemes.

% die höhere varianze durch mehr variablen, konnte nicht die fehlerrate senken, sondern

In examining the findings of the evaluation, it becomes evident that the M-LWE scheme exhibits both advantageous and disadvantageous characteristics. Prior to an in-depth examination of R-LWE and M-LWE, it is worthwhile to briefly consider the characteristics of Plain-LWE. It is evident that a homomorphic version based on BFV cannot be used to construct a secure encryption scheme with Plain-LWE. The primary challenge lies in the substantial memory requirements for the variables (see \ref{table:OutputVariableInKB}), particularly the relinearization key, which is significantly higher than what a practical implementation would allow. Even with future advancements in memory, networking for transmission, and computing power, the size will remain impractically large. Exchanging the key and performing operations with it will be computationally expensive, making it infeasible. This conclusion is particularly noteworthy given that the other two methods are perceived to be more effective.

A comprehensive assessment of R-LWE and M-LWE reveals that it is not a straightforward task to reach a definitive conclusion. A significant distinguishing factor between these two that merits consideration, particularly when evaluating practical encryption protocols, is the word size. This refers to the number of bits that each of the schemes is capable of encrypting and working with in a single operation. In the practical examples, R-LWE utilises a polynomial rank, that is equal to the word size, of $512$, while M-LWE employs a word size of $256$. As the majority of computations and data structures operate within a $32$- or $64$-bit system, these word sizes are the most relevant in practical applications. Even when larger numbers are employed, $256$- or $512$-bit numbers are uncommon. This raises the question of whether it might be advantageous to utilize smaller polynomial ranks and enhance security by scaling up the matrix dimension, $n$. This topic will be elaborated upon in the latter part of this conclusion.

Upon initial comparison of M-LWE and R-LWE based on their parameter sizes, R-LWE appears to exhibit superior characteristics. In contrast to M-LWE, the increase in parameters for R-LWE is always linear to the polynomial rank, $d$. Conversely, when the matrix dimension, $n$, is increased in M-LWE, the private key, $pk$, and the relinearization key, $rlk$, increase exponentially, resulting in a significant increase in memory consumption. 
In practice, smaller polynomial ranks are employed for M-LWE, however, this does not offset the growth in parameters resulting from higher matrix dimensions. This is evident from Table \ref{table:OutputVariableInKB}. The issue of the accelerated growth rate for the private key and the relinearization key is that these keys must be exchanged prior to the initiation of encrypted communication. Given a fixed speed and capacity of networks, the establishment of an encrypted channel is more time-consuming with M-LWE, as a greater volume of data must be transmitted. However, the ciphertext is smaller for M-LWE than for R-LWE, at least in practical analysis. This implies that, with sufficient data, the initial higher cost can be offset and potentially reduced over the course of communication, allowing for the storage of more data with the same amount of disk space. In an enterprise setting, this could enhance the viability of M-LWE over R-LWE. 

Another characteristic that seems superior in R-LWE in contrast to M-LWE is the processing time. As the calculations in R-LWE only depend on scalar polynomials, less operation need to be done compared to the vector and matrix processing of M-LWE. The big advantage of M-LWE is, that these matrix operations can easily run in parallel. So instead of running one big matrix multiplication, when multiplying two polynomials in R-LWE, multiple smaller matrix multiplications can run in parallel. For M-LWE the polynomial rank can also stay fixed and improving the security can be done purely by increasing the matrix dimension. Therefore optimized multiplications can be implemented based on this fixed size polynomials, instead of re-implementing optimized versions for the different R-LWE security levels based on different polynomial ranks. This matrix multiplication optimization has already be done for the Crystal Kyber encryption scheme \cite{CyrstalsKyber}, where hardware solutions have been constructed already (\cite{KyberHardware}, \cite{KyberHardware2}). If these can be reused this would create new synergies between different M-LWE based encryption schemes.

The depth of operations for both the tested R-LWE and M-LWE scheme appear to be essentially equivalent, as demonstrated in Table \ref{table:depthComparison}. It appears that the polynomial rank and matrix dimension exert a comparable influence on the outcome, suggesting that augmenting one while reducing the other results in outcomes that remain within a similar range. The most pronounced impact arises from the increase in modulus $q$, which is consistent across both versions.

One potential approach to enhancing the M-LWE HE scheme would be to optimize it by reducing the polynomial rank (thereby reducing the word size) and increasing the matrix dimension in a manner that minimizes the ciphertext size while maintaining the same security level and avoiding an excessive increase in memory size of the private key and relinearization key. This increases the number of matrix multiplications, but because of the smaller polynomial rank, these matrices are smaller. This could be used to run these calculations in parallel over multiple CPU cores or dedicated hardware like GPUs or TPUs, which are becoming increasingly accessible even in more affordable hardware, due to the advent of large language models.



% Probleme in der Arbeit
% Python macht rundungsfehler bei großen zahlen
% Security wurde komplett außer acht gelassen
% Die basis Version von BFV, ohne verbesserungen wurde verwendet, welche veraltet ist


% Future Work
% Making SWHE to FHE
% Analyzing security aspect in more detail
% Using different, more modern basis instead of BFV
% Trying improved implementation and maybe Hardware acceleration